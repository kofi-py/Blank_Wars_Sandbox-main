# Blank Wars: The Living Asset Ecosystem & Game Manual

> **Version**: 2.5
> **Date**: November 2025
> **Status**: Production Ready
> **Architecture**: Lazy-Loaded Web3 + Deep AI Simulation

---

# PART 1: THE LIVING ASSET ECOSYSTEM

## 1. The Vision: "The Tamagotchi That Talks Back"

Blank Wars is not just a card battler. It is a **Coach Simulator** set in a hyper-reality TV universe.

In traditional games, characters are tools‚Äîyou press "Attack", they attack.
In **Blank Wars**, characters are **"Living Assets"**:
-   They have **Personalities** (Ego, Greed, Loyalty).
-   They have **Financial Lives** (Wallets, Spending Habits, Debt).
-   They have **Domestic Drama** (Roommates, Chores, Jealousy).
-   They have **Autonomy** (They can say **NO**, or trashtalk other characters of their own accord).

**Your Role**: You are not the fighter. You are the **Coach**. Your job is to manage these chaotic, super-powered divas, keep them solvent, keep them sane, and guide them to victory.

---

## 2. The Core Loop: Coach vs. Athlete

The fundamental tension of the game is **Control vs. Autonomy**.

### The Coach (You)
You have your own progression system distinct from your characters.
-   **Coach Level**: Rookie -> Head Coach -> Legendary.
-   **Skill Trees**:
    1.  **Psychology Mastery**: Improves adherence and prevents mental breakdowns.
    2.  **Battle Strategy**: Unlocks advanced tactical commands.
    3.  **Character Development**: Accelerates XP gain and skill unlocking for your team.

### The Contestants (The NFT)
Your characters are autonomous entities.
-   **Adherence Score (0-100)**: How much they trust you.
-   **The Rebellion**: If Adherence drops (due to bad calls, low pay, or domestic squabbles), characters will **ignore your commands**.

#### üõ°Ô∏è Equipment Adherence
You don't just equip items; you *suggest* them.
-   **The Check**: When you try to equip a "Shield of Cowardice" on an arrogant Berserker, the system runs an Adherence Check.
-   **The Lockout**: If the check fails, the character will **refuse the item**.
    -   *"I'm not wearing that trash. I'm taking the Greatsword."*
-   **Consequence**: You are locked out of that equipment slot until you restore your relationship with that character and help them improve their adherence. The character chooses their own gear based on their personality traits.

#### üìà Leveling & Stat Adherence
You don't own the XP; the character does.
-   **The Allocation**: When a character levels up, you propose a stat build (e.g., "Put 5 points into Defense").
-   **The Survey**: If Adherence is low, the character will trigger a **"Pending Survey"**.
    -   They will present *their* preferred build options to you.
    -   *Example*: "I don't want Defense. I want Strength. Here are my terms."
-   **The Override**: If you can't reach an agreement, the character will **auto-allocate points** according to their own desires, permanently shaping the NFT's stats against your wishes.

#### üìà Adherence Tradeoff
-   Some of the most powerful characters have the highest egos and take the most work to develop a positive relationship with them and gain control of their actions. The coach's roster might have a mix of good controlable characters, with a super powerful character that is a loose canon but produces wins.

---

## 3. The "Blank" Canvas: Infinite IP Potential

Why is it called **Blank** Wars? Because the roster is a blank canvas that can absorb **any character from any time, place, or universe.**

### ‚ôæÔ∏è Infinite Character Possibilities
The game engine is agnostic to genre. It is designed to host:
-   **Public Domain Legends**: Dracula, Sherlock Holmes, Sun Wukong, King Arthur.
-   **Historical Figures**: Genghis Khan, Joan of Arc, Blackbeard.
-   **Mythological Deities**: Zeus, Anubis, Thor.
-   **Genre characters**: Skeleton Mage, Unicorn, Dragon.
-   **Random chaos characters**: Flying Toaster, Kangaroo, Velociraptor.

### ü§ù Licensing & Collaboration Engine
The system is built to seamlessly integrate **Licensed IP** and **Influencer Personas**.
-   **Influencer Cards**: A verified influencer can mint a "Hero Card" of themselves. Their fans can collect it, and the AI personality is prompt-gated on the influencer's actual content style, dynamically injected from the database in each scene. This creates a real influencer character that can actually be played in the game.
-   **Brand Deals**: We can make licensing deals to drop a "Marvel Pack" or a "Pokemon Pack" without breaking the game's lore, because the "Blank Wars" are a multiversal tournament where *everyone* is invited to fight.

**The Result**: An infinitely scalable roster where a user can field a team consisting of **Dracula, a Crypto Influencer, a Samurai, and beloved franchise characters**, all arguing about who has to do the dishes, living, training, and fighting together.

---

## 4. The Reality Engine: Dynamic AI Personalities

This is not a future promise. **It is live today.** The `promptAssemblyService` generates unique, unscripted experiences every time you play.

### üé≠ Dynamic Prompt Assembly
Every interaction is constructed in real-time using a "Universal Prompt Handler" that injects:
-   **Live Database State**: The AI knows its current Wallet Balance, Debt, and Roommates.
    -   *Example*: A character with $0 in their wallet will have an "Agitated" mood injected into their prompt.
-   **Comedy Injection**: Each character is assigned a specific **Comedy Style** (e.g., "Dry Sarcasm", "Slapstick", "Existential Dread") piped in from the database.
-   **Scene-Specific Variables**: The engine injects context like "Therapy Session", "Locker Room", or "Battlefield", changing the character's tone instantly.

### üé¨ User-Created Reality TV
Because the AI is dynamic, **you are the showrunner**.
-   **Unique Experiences**: You can go to any chat, and it will never be the same twice.
-   **Group Chat Chaos**: You can mix and match different character combos (e.g., Achilles + Merlin + A Toaster) to see how they interact.
-   **Conflict Injection**: The system autonomously injects drama.
    -   *Example*: The `masterBedConflictService` detects a sleeping arrangement disparity and forces the characters to argue about it in the group chat.

---

## 5. The Living World: Headquarters & Domestic Drama

Characters don't vanish when the battle ends. They go home to the **Headquarters**, where the real game begins.

### üè† The Shared Living Space
-   **Room Assignment**: You assign characters to rooms.
-   **The Hierarchy**:
    -   **Master Bedroom**: High morale, status symbol.
    -   **Bunk Beds**: Neutral.
    -   **The Floor**: Massive morale penalty.
-   **Master Bed Conflicts**: The game's "Drama Engine" injects domestic tension into every scene.
    -   *Scenario*: You are in a "Tactical Briefing". The engine detects that Character A is sleeping on the floor while Character B has the Master Bed. Character A interrupts the briefing to complain about back pain and favoritism.

### üõãÔ∏è Real Estate & Agents
-   **Buying Property**: You don't just click "Buy". You enter a chat with an **AI Real Estate Agent**.
-   **Negotiation**: You negotiate prices and features.
-   **Competitor Interruption**: Rival agents may barge into the chat with better offers, forcing you to make split-second financial decisions.

---

## 6. The Financial System: Wallets & Bidding

Every character has their own **Wallet** stored in the database. They earn money from battles, sponsorships, and allowances.

### üí∞ Financial Personalities
Characters have distinct spending styles:
-   **Conservative**: Savers. High adherence in financial matters.
-   **Impulsive**: Spenders. Prone to buying useless cosmetic items.
-   **Strategic**: Investors. Will save for better gear.

### "Reality Show" Mini-Games

#### üì¶ Storage Locker Auctions
Characters participate in storage unit auctions to find rare gear.
-   **The Setup**: You (Coach) set a **Budget** and a **Strategy** (e.g., "Don't go over $500").
-   **The Rogue Factor**:
    -   If Adherence is high, the character follows your limit.
    -   If Adherence is low the character may **Go Rogue**.
    -   *Rogue AI*: The AI evaluates the situation: *"Coach said stop at $500, but I smell Mythic loot. I'm bidding $800!"*
-   **Consequences**: If they win big, Adherence goes up. If they lose your money, Adherence tanks.

#### üî¥ Beast Blank Ball
-   You control the characters and guide them through a wipeout-style obstacle course that is weird enough for the Blank Wars universe.
    -   Bounce on different colored balls with varying levels of bounciness.
    -   Avoid flying animals trying to knock you off the platform.

#### üå≥ Arbor Apocalypse
-   Delivery trees for a nursery while comets rain from the sky and monsters try to take out your trees.
-   When trees catch fire put them out by driving through puddles of water.

#### ü•£ Other Reality Show Mini Games Coming Soon
-   **Cereal Wars**: A parody of Cake Wars and other Iron Chef style competitions.
-   Solicit new mini-games from developer community.

---

## 7. Asset Tiers & Rich Metadata

The NFT is not just a receipt; it is a container for rich media assets that evolve.

### üñºÔ∏è Visual Tiers
-   **Standard Tier**: 2D Character Card (The classic trading card look).
-   **Premium Tier**: Animated 2D Assets (Live2D or Spine animations).
-   **Elite Tier**: **Full 3D Models**.
    -   These are the actual 3D assets used in the game's cutscenes and battle replays.
    -   Owning the NFT grants you the license to use this 3D model in other metaverse applications or content creation tools.

### üíæ Dynamic Metadata (CIP-68)
-   **Stats**: Level, Attack, Defense (synced from DB).
-   **History**: Win/Loss record, Rivalries.
-   **Visuals**: The metadata points to the specific IPFS hash of the 3D model or image variant currently equipped.

---

## 8. Communication & Social Systems

### üì± The Inbox & Internal Mail
-   **System Mails**: Rewards, Level-ups, Patch notes.
-   **Coach Mail**: Direct messages from other players.
-   **Character DMs**: Your characters will message you autonomously.
    -   *"Hey Coach, thanks for the new sword."*
    -   *"Why does Steve get the Master Bed? I quit."*

### üó£Ô∏è AI Trash Talk Service
-   **Post-Battle**: The `AutonomousTrashTalkScheduler` analyzes battle results.
-   **Context-Aware**:
    -   **Close Win**: "Good game, nearly had me."
    -   **Stomp**: "Ez. Uninstall."
-   **Living History**: These messages are saved to the blockchain metadata (optional) or game history, creating a permanent record of rivalries.

---

# PART 2: TECHNICAL INTEGRATION & ARCHITECTURE

## 9. The "Twin" System Architecture

How do we build this complex simulation on a blockchain? We don't. We build it **alongside** it.

### Architecture
1.  **Database Truth (PostgreSQL)**:
    -   Handles high-frequency data: Adherence, Morale, Chat Logs, Domestic State.
    -   Services: `headquartersService`, `masterBedConflictService`, `coachProgressionService`, `attributeService`.
2.  **Blockchain Anchor (Cardano)**:
    -   Handles ownership and major milestones.
    -   **Minting**: Converts the "Database Soul" into a tradable asset.
    -   **CIP-68**: Updates on-chain metadata to reflect Level, Wins, and Major Achievements.
    -   **On-Chain Governance**: Adherence failures and "Rogue" decisions can be recorded on-chain, proving that the asset truly has a mind of its own.

### Lazy Loading (The "Fail-Safe")
-   **Web2 First**: The game is fully functional without a wallet.
-   **On-Demand Web3**: Blockchain services (`CardanoProviderService`) are only instantiated when a user explicitly connects a wallet or mints an item.
-   **Zero-Crash Guarantee**: Missing API keys or network errors will never crash the game server; they only disable the specific "Mint" button.

---

## 10. Core Services

### `CardanoProviderService.ts`
The backbone of the integration.
-   **Strict Mode**: Throws errors on missing configuration (`CARDANO_API_KEY`, `CARDANO_NETWORK`).
-   **Lazy Initialization**: Uses a Proxy pattern to ensure the service is only created when accessed, preventing startup crashes.
-   **Functionality**:
    -   `fetchWalletAssets(address)`: Retrieves all assets for a wallet.
    -   `verifyNftOwnership(address, fingerprint)`: Confirms ownership of specific NFTs.
    -   `resolveStakeKey(address)`: Converts payment addresses to stake addresses.

### `CardanoMintingService.ts`
Handles the creation of "Living Assets".
-   **Standard**: Implements **CIP-68** (Reference Token + Metadata Token).
-   **Validation**: Checks `minting_active`, `max_supply`, and minting windows before execution.
-   **Metadata Generation**: Automatically builds rich metadata from the character's database state (Level, Wins, Psychology).

### `aiTrashTalkService.ts`
The bridge between gameplay and personality.
-   **Trigger**: Runs post-battle.
-   **Logic**: Analyzes the battle log (who won, how close was it?).
-   **Output**: Generates a signed message from the character to be displayed in the game and potentially recorded on-chain.

---

## 11. Configuration & Troubleshooting

### Environment Variables
Required for Web3 features to function (but optional for game startup):
```env
CARDANO_NETWORK=mainnet  # or 'preprod'
CARDANO_API_KEY=blockfrost_api_key_here
```

### Common Issues
1.  **"Mint Button Disabled"**:
    -   Check if `CARDANO_API_KEY` is set in Railway.
    -   Check if the `card_packs` table has `minting_active = true`.
2.  **"Application Crashes on Start"**:
    -   This should **NOT** happen anymore due to Lazy Loading. If it does, check `CardanoProviderService` instantiation.
3.  **"Metadata Mismatch"**:
    -   The DB is the source of truth. If on-chain metadata lags, run the `syncMetadataToChain` job.

---

## 12. Conclusion

Blank Wars is a **Social Simulation** wrapped in a **Strategy RPG**, anchored by **Blockchain Ownership**.

We are not just building a game. We are building a platform for **Emergent Narrative**, where the assets you own have a life of their own.
